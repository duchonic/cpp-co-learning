CMAKE_MINIMUM_REQUIRED(VERSION 3.2)
PROJECT(Weather)

# To run with Clang:
# cmake -DCMAKE_CXX_COMPILER=/usr/bin/clang++ -DCMAKE_CC_COMPILER=/usr/bin/clang .. 

SET(CMAKE_CXX_STANDARD 14)

SET(CMAKE_MODULE_PATH "${PROJECT_SOURCE_DIR}" "${CMAKE_MODULE_PATH}")

FIND_PACKAGE(ZeroMQ)

ADD_EXECUTABLE(server server.cpp)

TARGET_INCLUDE_DIRECTORIES(server PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_SOURCE_DIR}
    ${ZeroMQ_INCLUDE_DIR}
)

TARGET_LINK_LIBRARIES(server LINK_PUBLIC
    ${ZeroMQ_LIBRARIES}
)

ADD_EXECUTABLE(client client.cpp)

TARGET_INCLUDE_DIRECTORIES(client PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_SOURCE_DIR}
    ${ZeroMQ_INCLUDE_DIR}
)

TARGET_LINK_LIBRARIES(client LINK_PUBLIC
    ${ZeroMQ_LIBRARIES}
)

ADD_EXECUTABLE(client-non-blocking client-non-blocking.cpp)

TARGET_INCLUDE_DIRECTORIES(client-non-blocking PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_SOURCE_DIR}
    ${ZeroMQ_INCLUDE_DIR}
)

TARGET_LINK_LIBRARIES(client-non-blocking LINK_PUBLIC
    ${ZeroMQ_LIBRARIES}
)

IF (WIN32)
  set_property(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} PROPERTY VS_STARTUP_PROJECT ZeroMQ)
  set_target_properties(hwserver PROPERTIES VS_DEBUGGER_WORKING_DIRECTORY $(Configuration))
ENDIF (WIN32)
